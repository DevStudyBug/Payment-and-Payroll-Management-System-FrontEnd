<!-- org-admin-dashboard-component.html -->

<div class="org-wrapper">
  <!-- Sidebar Navigation -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="logo">
        <span class="logo-icon">ğŸ’¼</span>
        <span class="logo-text">PayFlow Pro</span>
      </div>
    </div>

    <nav class="sidebar-nav">
      <button 
        class="nav-item" 
        [class.active]="activeTab === 'dashboard'"
        [class.disabled]="false"
        (click)="switchTab('dashboard')">
        <span class="nav-icon">ğŸ“Š</span>
        <span class="nav-label">Dashboard</span>
      </button>

      <button 
        class="nav-item" 
        [class.active]="activeTab === 'designations'"
        [class.disabled]="!canAccessFeature()"
        (click)="switchTab('designations')">
        <span class="nav-icon">ğŸ‘”</span>
        <span class="nav-label">Designations</span>
        <span *ngIf="!canAccessFeature()" class="lock-icon">ğŸ”’</span>
      </button>

      <button 
        class="nav-item" 
        [class.active]="activeTab === 'templates'"
        [class.disabled]="!canAccessFeature()"
        (click)="switchTab('templates')">
        <span class="nav-icon">ğŸ“‹</span>
        <span class="nav-label">Salary Templates</span>
        <span *ngIf="!canAccessFeature()" class="lock-icon">ğŸ”’</span>
      </button>

      <button 
        class="nav-item" 
        [class.active]="activeTab === 'employees'"
        [class.disabled]="!canAccessFeature()"
        (click)="switchTab('employees')">
        <span class="nav-icon">ğŸ‘¥</span>
        <span class="nav-label">Employees</span>
        <span *ngIf="!canAccessFeature()" class="lock-icon">ğŸ”’</span>
      </button>

      <button 
        class="nav-item" 
        [class.active]="activeTab === 'payroll'"
        [class.disabled]="!canAccessFeature()"
        (click)="switchTab('payroll')">
        <span class="nav-icon">ğŸ’°</span>
        <span class="nav-label">Payroll</span>
        <span *ngIf="!canAccessFeature()" class="lock-icon">ğŸ”’</span>
      </button>

      <button 
        class="nav-item" 
        [class.active]="activeTab === 'concerns'"
        [class.disabled]="!canAccessFeature()"
        (click)="switchTab('concerns')">
        <span class="nav-icon">ğŸ«</span>
        <span class="nav-label">Support Tickets</span>
        <span *ngIf="!canAccessFeature()" class="lock-icon">ğŸ”’</span>
      </button>

      <button 
        class="nav-item logout-btn"
        (click)="logout()">
        <span class="nav-icon">ğŸšª</span>
        <span class="nav-label">Logout</span>
      </button>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Header -->
    <header class="page-header">
      <div class="header-left">
        <h1>Organization Admin Dashboard</h1>
        <p class="header-subtitle">Manage your organization efficiently</p>
      </div>
      <div class="header-actions">
        <div class="user-info">
          <span class="user-avatar">ğŸ‘¤</span>
          <span class="user-name">Admin Account</span>
        </div>
      </div>
    </header>

    <!-- Loading Overlay -->
    <div *ngIf="isLoading" class="loading-overlay">
      <div class="loading-spinner"></div>
      <p>Processing...</p>
    </div>

    <!-- Messages -->
    <div *ngIf="successMessage" class="alert alert-success">
      <span class="alert-icon">âœ“</span>
      <span class="alert-message">{{ successMessage }}</span>
      <button class="close-btn" (click)="clearMessages()">Ã—</button>
    </div>

    <div *ngIf="errorMessage" class="alert alert-error">
      <span class="alert-icon">âœ•</span>
      <span class="alert-message">{{ errorMessage }}</span>
      <button class="close-btn" (click)="clearMessages()">Ã—</button>
    </div>

    <!-- Dashboard Tab -->
    <section *ngIf="activeTab === 'dashboard'" class="content-section">
      <div class="section-header">
        <h2>Onboarding Overview</h2>
        <p class="section-description">Complete your organization setup to unlock all features</p>
      </div>

      <div class="dashboard-grid">
        <!-- Overall Progress Card -->
        <div class="card progress-card">
          <div class="card-header">
            <h3>Overall Progress</h3>
            <span class="progress-percentage">{{ getProgress() }}%</span>
          </div>
          <div class="progress-container">
            <div class="progress-bar">
              <div class="progress-fill" [style.width.%]="getProgress()">
                <span class="progress-label">{{ getProgress() }}%</span>
              </div>
            </div>
          </div>
          <div class="progress-actions">
            <button class="btn btn-primary btn-sm" (click)="openDocumentModal()" 
                    *ngIf="onboardingStatus?.documentStage !== 'APPROVED'">
              ğŸ“„ Upload Documents
            </button>
            <button class="btn btn-primary btn-sm" (click)="openBankModal()"
                    *ngIf="onboardingStatus?.bankStage !== 'APPROVED'">
              ğŸ¦ Add Bank Details
            </button>
          </div>
        </div>

        <!-- Organization Status -->
        <div class="card status-card">
          <div class="card-header">
            <h3>Organization Status</h3>
          </div>
          <div class="status-content">
            <div class="status-badge-large" [ngClass]="onboardingStatus?.organizationStatus?.toLowerCase()">
              {{ onboardingStatus?.organizationStatus || 'PENDING' }}
            </div>
            <p class="status-message">{{ onboardingStatus?.message || 'Please complete your onboarding' }}</p>
          </div>
        </div>

        <!-- Document Status -->
        <div class="card">
          <div class="card-header">
            <h3>ğŸ“„ Document Status</h3>
            <span class="status-badge" [ngClass]="onboardingStatus?.documentStage?.toLowerCase()">
              {{ onboardingStatus?.documentStage || 'PENDING' }}
            </span>
          </div>
          <div class="status-items">
            <div class="status-item">
              <div class="status-item-label">
                <span class="status-icon">âœ…</span>
                <span>Approved</span>
              </div>
              <span class="status-item-value">{{ onboardingStatus?.approvedDocuments || 0 }}</span>
            </div>
            <div class="status-item">
              <div class="status-item-label">
                <span class="status-icon">ğŸ“‘</span>
                <span>Total Documents</span>
              </div>
              <span class="status-item-value">{{ onboardingStatus?.totalDocuments || 0 }}</span>
            </div>
            <div class="status-item">
              <div class="status-item-label">
                <span class="status-icon">âŒ</span>
                <span>Rejected</span>
              </div>
              <span class="status-item-value">{{ onboardingStatus?.rejectedDocuments || 0 }}</span>
            </div>
          </div>
        </div>

        <!-- Bank Status -->
        <div class="card">
          <div class="card-header">
            <h3>ğŸ¦ Bank Account Status</h3>
            <span class="status-badge" [ngClass]="onboardingStatus?.bankStage?.toLowerCase()">
              {{ onboardingStatus?.bankStage || 'PENDING' }}
            </span>
          </div>
          <div class="status-items">
            <div class="status-item">
              <div class="status-item-label">
                <span class="status-icon">ğŸ“‹</span>
                <span>Stage</span>
              </div>
              <span class="status-item-value">{{ onboardingStatus?.bankStage || 'NOT SUBMITTED' }}</span>
            </div>
            <div class="status-item" *ngIf="onboardingStatus?.bankVerifiedBy">
              <div class="status-item-label">
                <span class="status-icon">âœ“</span>
                <span>Verified By</span>
              </div>
              <span class="status-item-value">{{ onboardingStatus?.bankVerifiedBy }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Quick Actions -->
      <div class="quick-actions" *ngIf="!isOnboardingComplete()">
        <h3>âš¡ Quick Actions</h3>
        <div class="action-cards">
          <div class="action-card" *ngIf="onboardingStatus?.documentStage !== 'APPROVED'">
            <div class="action-icon">ğŸ“„</div>
            <h4>Upload Documents</h4>
            <p>Submit required organization documents for verification</p>
            <button class="btn btn-primary" (click)="openDocumentModal()">Upload Now</button>
          </div>
          <div class="action-card" *ngIf="onboardingStatus?.bankStage !== 'APPROVED'">
            <div class="action-icon">ğŸ¦</div>
            <h4>Add Bank Details</h4>
            <p>Provide bank account information for payroll processing</p>
            <button class="btn btn-primary" (click)="openBankModal()">Add Details</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Designations Tab -->
    <section *ngIf="activeTab === 'designations'" class="content-section">
      <div class="section-header">
        <h2>Manage Designations</h2>
        <p class="section-description">Create and manage job designations for your organization</p>
      </div>

      <div class="form-card">
        <div class="form-card-header">
          <h3>â• Add New Designation</h3>
        </div>
        <form [formGroup]="designationForm" (ngSubmit)="addDesignation()">
          <div class="form-group">
            <label for="designationName">Designation Name <span class="required">*</span></label>
            <input 
              type="text" 
              id="designationName" 
              formControlName="name"
              placeholder="e.g., Software Engineer, Manager"
              class="form-input"
              [class.error]="designationForm.get('name')?.invalid && designationForm.get('name')?.touched">
            <span *ngIf="designationForm.get('name')?.invalid && designationForm.get('name')?.touched" class="error-text">
              âš ï¸ Designation name is required (minimum 2 characters)
            </span>
          </div>
          <button type="submit" class="btn btn-primary" [disabled]="isLoading || designationForm.invalid">
            <span *ngIf="!isLoading">âœ“ Add Designation</span>
            <span *ngIf="isLoading" class="loading-spinner"></span>
          </button>
        </form>
      </div>

      <div class="table-card">
        <div class="table-card-header">
          <h3>ğŸ“‹ Existing Designations</h3>
          <span class="count-badge">{{ designations.length }} Total</span>
        </div>
        <div class="table-responsive">
          <table class="data-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Designation Name</th>
                <th class="text-right">Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let designation of designations; let i = index" [@fadeIn]>
                <td><span class="id-badge">#{{ designation.designationId }}</span></td>
                <td><strong>{{ designation.name }}</strong></td>
                <td class="text-right">
                  <button class="btn btn-sm btn-secondary">âœï¸ Edit</button>
                </td>
              </tr>
            </tbody>
          </table>
          <div *ngIf="designations.length === 0" class="no-data">
            <div class="no-data-icon">ğŸ“­</div>
            <p>No designations found</p>
            <small>Create your first designation to get started</small>
          </div>
        </div>
      </div>
    </section>

    <!-- Salary Templates Tab -->
    <section *ngIf="activeTab === 'templates'" class="content-section">
      <div class="section-header">
        <h2>Salary Templates</h2>
        <p class="section-description">Create salary structures for different designations</p>
      </div>

      <div class="form-card">
        <div class="form-card-header">
          <h3>â• Create Salary Template</h3>
        </div>
        <form [formGroup]="salaryTemplateForm" (ngSubmit)="createSalaryTemplate()">
          <div class="form-row">
            <div class="form-group">
              <label for="designation">Designation <span class="required">*</span></label>
              <select id="designation" formControlName="designation" class="form-input">
                <option value="">Select Designation</option>
                <option *ngFor="let d of designations" [value]="d.designationId">
                  {{ d.name }}
                </option>
              </select>
            </div>
            <div class="form-group">
              <label for="basicSalary">Basic Salary (â‚¹) <span class="required">*</span></label>
              <input 
                type="number" 
                id="basicSalary" 
                formControlName="basicSalary"
                placeholder="0.00"
                class="form-input">
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="hra">HRA (â‚¹) <span class="required">*</span></label>
              <input 
                type="number" 
                id="hra" 
                formControlName="hra"
                placeholder="0.00"
                class="form-input">
            </div>
            <div class="form-group">
              <label for="da">DA (â‚¹) <span class="required">*</span></label>
              <input 
                type="number" 
                id="da" 
                formControlName="da"
                placeholder="0.00"
                class="form-input">
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="pf">PF (â‚¹) <span class="required">*</span></label>
              <input 
                type="number" 
                id="pf" 
                formControlName="pf"
                placeholder="0.00"
                class="form-input">
            </div>
            <div class="form-group">
              <label for="otherAllowances">Other Allowances (â‚¹) <span class="required">*</span></label>
              <input 
                type="number" 
                id="otherAllowances" 
                formControlName="otherAllowances"
                placeholder="0.00"
                class="form-input">
            </div>
          </div>

          <button type="submit" class="btn btn-primary" [disabled]="isLoading || salaryTemplateForm.invalid">
            <span *ngIf="!isLoading">âœ“ Create Template</span>
            <span *ngIf="isLoading" class="loading-spinner"></span>
          </button>
        </form>
      </div>

      <div class="table-card">
        <div class="table-card-header">
          <h3>ğŸ“‹ Salary Templates</h3>
          <span class="count-badge">{{ salaryTemplates.length }} Templates</span>
        </div>
        <div class="table-responsive">
          <table class="data-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Designation</th>
                <th>Gross Salary</th>
                <th>Net Salary</th>
                <th class="text-right">Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let template of salaryTemplates">
                <td><span class="id-badge">#{{ template.templateId }}</span></td>
                <td><strong>{{ template.designation }}</strong></td>
                <td><span class="amount">â‚¹{{ template.grossSalary | number:'1.2-2' }}</span></td>
                <td><span class="amount success">â‚¹{{ template.netSalary | number:'1.2-2' }}</span></td>
                <td class="text-right">
                  <button class="btn btn-sm btn-secondary">ğŸ‘ï¸ View</button>
                </td>
              </tr>
            </tbody>
          </table>
          <div *ngIf="salaryTemplates.length === 0" class="no-data">
            <div class="no-data-icon">ğŸ“Š</div>
            <p>No salary templates found</p>
            <small>Create your first template to get started</small>
          </div>
        </div>

        <!-- Pagination -->
        <div class="pagination" *ngIf="totalPages > 1">
          <button class="btn btn-sm btn-secondary" (click)="previousPage()" [disabled]="currentPage === 0">
            â† Previous
          </button>
          <span class="page-info">Page {{ currentPage + 1 }} of {{ totalPages }}</span>
          <button class="btn btn-sm btn-secondary" (click)="nextPage()" [disabled]="currentPage >= totalPages - 1">
            Next â†’
          </button>
        </div>
      </div>
    </section>

    <!-- Employees Tab -->
    <section *ngIf="activeTab === 'employees'" class="content-section">
      <div class="section-header">
        <h2>Employee Management</h2>
        <p class="section-description">Register and manage your organization's employees</p>
      </div>

      <div class="two-column-layout">
        <div class="form-card">
          <div class="form-card-header">
            <h3>â• Register Employee</h3>
          </div>
          <form [formGroup]="employeeForm" (ngSubmit)="registerEmployee()">
            <div class="form-row">
              <div class="form-group">
                <label for="firstName">First Name <span class="required">*</span></label>
                <input 
                  type="text" 
                  id="firstName" 
                  formControlName="firstName"
                  placeholder="First Name"
                  class="form-input">
              </div>
              <div class="form-group">
                <label for="lastName">Last Name <span class="required">*</span></label>
                <input 
                  type="text" 
                  id="lastName" 
                  formControlName="lastName"
                  placeholder="Last Name"
                  class="form-input">
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="dob">Date of Birth <span class="required">*</span></label>
                <input 
                  type="date" 
                  id="dob" 
                  formControlName="dob"
                  class="form-input">
              </div>
              <div class="form-group">
                <label for="email">Email <span class="required">*</span></label>
                <input 
                  type="email" 
                  id="email" 
                  formControlName="email"
                  placeholder="email@example.com"
                  class="form-input">
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="department">Department <span class="required">*</span></label>
                <input 
                  type="text" 
                  id="department" 
                  formControlName="department"
                  placeholder="Department"
                  class="form-input">
              </div>
              <div class="form-group">
                <label for="designation">Designation <span class="required">*</span></label>
                <select id="designation" formControlName="designation" class="form-input">
                  <option value="">Select Designation</option>
                  <option *ngFor="let d of designations" [value]="d.name">
                    {{ d.name }}
                  </option>
                </select>
              </div>
            </div>

            <button type="submit" class="btn btn-primary btn-block" [disabled]="isLoading || employeeForm.invalid">
              <span *ngIf="!isLoading">âœ“ Register Employee</span>
              <span *ngIf="isLoading" class="loading-spinner"></span>
            </button>
          </form>
        </div>

        <div class="form-card">
          <div class="form-card-header">
            <h3>ğŸ“‚ Bulk Upload (Excel)</h3>
          </div>
          <div class="file-upload-area">
            <div class="file-upload-icon">ğŸ“Š</div>
            <h4>Upload Employee Data</h4>
            <p>Upload an Excel file (.xlsx, .xls) with employee details</p>
            <label for="excelFile" class="btn btn-primary">
              Choose File
              <input 
                type="file" 
                id="excelFile" 
                accept=".xlsx,.xls"
                (change)="uploadEmployeesExcel($event)"
                style="display: none;">
            </label>
            <small class="file-hint">Supported formats: .xlsx, .xls</small>
          </div>
        </div>
      </div>

      <div class="table-card">
        <div class="table-card-header">
          <h3>ğŸ‘¥ Employees</h3>
          <span class="count-badge">{{ employees.length }} Total</span>
        </div>
        <div class="table-responsive">
          <table class="data-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Email</th>
                <th>Status</th>
                <th>Document Progress</th>
                <th class="text-right">Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let emp of employees">
                <td><span class="id-badge">#{{ emp.employeeId }}</span></td>
                <td><strong>{{ emp.employeeName }}</strong></td>
                <td>{{ emp.email }}</td>
                <td>
                  <span class="status-badge" [ngClass]="emp.status?.toLowerCase()">
                    {{ emp.status }}
                  </span>
                </td>
                <td>
                  <div class="inline-progress">
                    <div class="progress-bar mini">
                      <div class="progress-fill" [style.width.%]="emp.documentCompletion || 0"></div>
                    </div>
                    <span class="progress-text">{{ emp.documentCompletion || 0 }}%</span>
                  </div>
                </td>
                <td class="text-right">
                  <button class="btn btn-sm btn-secondary">ğŸ‘ï¸ View</button>
                </td>
              </tr>
            </tbody>
          </table>
          <div *ngIf="employees.length === 0" class="no-data">
            <div class="no-data-icon">ğŸ‘¥</div>
            <p>No employees found</p>
            <small>Register your first employee to get started</small>
          </div>
        </div>
      </div>
    </section>

    <!-- Payroll Tab -->
    <section *ngIf="activeTab === 'payroll'" class="content-section">
      <div class="section-header">
        <h2>Payroll Management</h2>
        <p class="section-description">Generate and submit monthly payroll</p>
      </div>

      <div class="payroll-card">
        <div class="payroll-card-header">
          <h3>ğŸ’° Monthly Payroll</h3>
        </div>
        <div class="payroll-content">
          <div class="form-group">
            <label for="payrollMonth">Select Month <span class="required">*</span></label>
            <input 
              type="month" 
              id="payrollMonth"
              #monthInput
              class="form-input">
          </div>
          <div class="button-group">
            <button class="btn btn-primary btn-lg" (click)="generatePayroll(monthInput.value)" [disabled]="isLoading">
              <span *ngIf="!isLoading">ğŸ”„ Generate Payroll</span>
              <span *ngIf="isLoading" class="loading-spinner"></span>
            </button>
            <button class="btn btn-success btn-lg" (click)="submitPayroll(monthInput.value)" [disabled]="isLoading">
              <span *ngIf="!isLoading">ğŸ¦ Submit to Bank</span>
              <span *ngIf="isLoading" class="loading-spinner"></span>
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Support Tickets Tab -->
    <section *ngIf="activeTab === 'concerns'" class="content-section">
      <div class="section-header">
        <h2>Support Tickets</h2>
        <p class="section-description">Manage employee support requests and concerns</p>
      </div>

      <div class="table-card">
        <div class="table-card-header">
          <h3>ğŸ« All Tickets</h3>
          <span class="count-badge">{{ concerns.length }} Tickets</span>
        </div>
        <div class="table-responsive">
          <table class="data-table">
            <thead>
              <tr>
                <th>Ticket #</th>
                <th>Employee</th>
                <th>Category</th>
                <th>Priority</th>
                <th>Status</th>
                <th>Created</th>
                <th class="text-right">Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let concern of concerns">
                <td><span class="ticket-badge">{{ concern.ticketNumber }}</span></td>
                <td><strong>{{ concern.employeeName }}</strong></td>
                <td>{{ concern.category }}</td>
                <td>
                  <span class="badge" [ngClass]="concern.priority?.toLowerCase()">
                    {{ concern.priority }}
                  </span>
                </td>
                <td>
                  <span class="status-badge" [ngClass]="concern.status?.toLowerCase()">
                    {{ concern.status }}
                  </span>
                </td>
                <td>{{ concern.createdAt | date:'short' }}</td>
                <td class="text-right">
                  <button class="btn btn-sm btn-secondary">ğŸ‘ï¸ View</button>
                </td>
              </tr>
            </tbody>
          </table>
          <div *ngIf="concerns.length === 0" class="no-data">
            <div class="no-data-icon">ğŸ«</div>
            <p>No support tickets found</p>
            <small>Tickets will appear here when employees raise concerns</small>
          </div>
        </div>

        <!-- Pagination -->
        <div class="pagination" *ngIf="totalPages > 1">
          <button class="btn btn-sm btn-secondary" (click)="previousPage()" [disabled]="currentPage === 0">
            â† Previous
          </button>
          <span class="page-info">Page {{ currentPage + 1 }} of {{ totalPages }}</span>
          <button class="btn btn-sm btn-secondary" (click)="nextPage()" [disabled]="currentPage >= totalPages - 1">
            Next â†’
          </button>
        </div>
      </div>
    </section>
  </main>

  <!-- Document Upload Modal -->
  <div class="modal-overlay" *ngIf="showDocumentModal" (click)="closeDocumentModal()">
    <div class="modal" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>ğŸ“„ Upload Documents</h3>
        <button class="modal-close" (click)="closeDocumentModal()">Ã—</button>
      </div>
      <div class="modal-body">
        <form [formGroup]="documentUploadForm">
          <div formArrayName="documents">
            <div *ngFor="let doc of documentsArray.controls; let i = index" [formGroupName]="i" class="document-item">
              <div class="document-item-header">
                <h4>Document {{ i + 1 }}</h4>
                <button type="button" class="btn-icon" (click)="removeDocumentField(i)" *ngIf="documentsArray.length > 1">
                  ğŸ—‘ï¸
                </button>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label>File Name <span class="required">*</span></label>
                  <input type="text" formControlName="fileName" placeholder="Document name" class="form-input">
                </div>
                <div class="form-group">
                  <label>File Type <span class="required">*</span></label>
                  <input type="text" formControlName="fileType" placeholder="e.g., Registration Certificate" class="form-input">
                </div>
              </div>
              <div class="form-group">
                <label>Choose File <span class="required">*</span></label>
                <input type="file" (change)="onFileSelected($event, i)" class="form-input">
              </div>
            </div>
          </div>
          <button type="button" class="btn btn-secondary btn-block" (click)="addDocumentField()">
            â• Add Another Document
          </button>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeDocumentModal()">Cancel</button>
        <button class="btn btn-primary" (click)="uploadDocuments()" [disabled]="isLoading || documentUploadForm.invalid">
          <span *ngIf="!isLoading">âœ“ Upload Documents</span>
          <span *ngIf="isLoading" class="loading-spinner"></span>
        </button>
      </div>
    </div>
  </div>

  <!-- Bank Details Modal -->
  <div class="modal-overlay" *ngIf="showBankModal" (click)="closeBankModal()">
    <div class="modal" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>ğŸ¦ Bank Account Details</h3>
        <button class="modal-close" (click)="closeBankModal()">Ã—</button>
      </div>
      <div class="modal-body">
        <form [formGroup]="bankDetailsForm">
          <div class="form-group">
            <label for="accountNumber">Account Number <span class="required">*</span></label>
            <input 
              type="text" 
              id="accountNumber" 
              formControlName="accountNumber"
              placeholder="Enter account number"
              class="form-input">
          </div>

          <div class="form-group">
            <label for="ifscCode">IFSC Code <span class="required">*</span></label>
            <input 
              type="text" 
              id="ifscCode" 
              formControlName="ifscCode"
              placeholder="e.g., SBIN0001234"
              class="form-input">
          </div>

          <div class="form-group">
            <label for="bankName">Bank Name <span class="required">*</span></label>
            <input 
              type="text" 
              id="bankName" 
              formControlName="bankName"
              placeholder="Enter bank name"
              class="form-input">
          </div>

          <div class="form-group">
            <label for="accountHolderName">Account Holder Name <span class="required">*</span></label>
            <input 
              type="text" 
              id="accountHolderName" 
              formControlName="accountHolderName"
              placeholder="Enter account holder name"
              class="form-input">
          </div>

          <div class="form-group">
            <label for="branchName">Branch Name</label>
            <input 
              type="text" 
              id="branchName" 
              formControlName="branchName"
              placeholder="Enter branch name (optional)"
              class="form-input">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeBankModal()">Cancel</button>
        <button class="btn btn-primary" (click)="submitBankDetails()" [disabled]="isLoading || bankDetailsForm.invalid">
          <span *ngIf="!isLoading">âœ“ Submit Details</span>
          <span *ngIf="isLoading" class="loading-spinner"></span>
        </button>
      </div>
    </div>
  </div>
</div>